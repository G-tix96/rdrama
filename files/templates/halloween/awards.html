<style>
	.modal {
		z-index:99999 !important;
	}
</style>

{% if p.award_count("haunt", v) %}
<script src="{{'js/halloween/haunted.js' | asset}}" defer></script>
<div id="haunted-effect" class="fixed-top"></div>
<style>
	#haunted-effect {
		position: fixed;
		width:100%;
		height:100%;
		pointer-events:none;
	}
	#haunt-bg{
		position: fixed;
		background-repeat: no-repeat;
		width: 100%;
		height: 100%;
		pointer-events:none;
		background-color: var(--background);
		z-index:0;
	}
</style>
{% endif %}

{% set stab = p.award_count("stab", v) %}
{% if stab %}
	{% if stab > 3 %}
		{% set stab = 3 %}
	{% endif %}
<script src="{{'js/halloween/sketch.js' | asset}}" defer></script>
<script src="{{'js/halloween/blood.js' | asset}}" defer></script>
<script>let stabs = {{ stab }}</script>
<style>
	canvas.sketch {
		opacity: calc(0.1*{{ stab }});
	}
</style>
{% endif %}

{% if p.award_count("spiders", v) %}
	{% set spiders = p.award_count("spiders", v) %}

	{% for i in range(spiders) %}
		{% include "halloween/spider.html" %}
	{% endfor %}
{% endif %}

{% if p.award_count("fog", v) %}
<canvas id="fog-effect" class="fog-effect"></canvas>
<script src="{{'js/halloween/fog.js' | asset}}" defer></script>
{% endif %}

{% if p.award_count("flashlight", v) %}
<style>
	#flashlight-effect {
		--Xpos: 50vw;
		--Ypos: 50vh;
		position: fixed;
		width:100%;
		height:100%;
		z-index:1061;
		pointer-events:none;
		opacity:0.8;
		backdrop-filter: brightness(1.5);
	}
	#flashlight-effect:before {
		content: "";
		display: block;
		width: 100%;
		height: 100%;
		position: absolute;
		pointer-events: none;
		background: radial-gradient(
			circle 30vmax at var(--Xpos) var(--Ypos),
			rgba(0,0,0,0) 0%,
			rgba(0,0,0,.5) 70%,
			rgba(0,0,0,.93) 100%
			);
		z-index: 1061;
	}
	@media (max-width: 767.98px) {
		#flashlight-effect::before {
			background: radial-gradient(
				circle 20em at 50% var(--Ypos),
				rgba(0,0,0,0) 0%,
				rgba(0,0,0,0) 80%,
				rgba(0,0,0,.93) 100%
			);
			opacity:0.8;
			pointer-events: none;
		}
	}
</style>
<div id="flashlight-effect" class="fixed-top"></div>
<script src="{{'js/halloween/flashlight.js' | asset}}"></script>
{% endif %}

{% if p.award_count("ectoplasm", v) %}
<style>
	#banner-halloween-title {
		text-shadow: 0 0 40px #3AE63A;
		fill: #90ee90;
	}
</style>
{% endif %}

{% if p.award_count("bones", v) %}
<div id="animate"></div>
<script src="{{'js/halloween/bones.js' | asset}}"></script>
<script defer>
	bones({{ p.award_count("bones", v) }})
</script>
{% endif %}

{% if p.award_count("pumpkin", v) %}
{% set count = p.award_count("pumpkin", v) * 2 if p.award_count("pumpkin", v) <= 10 else 20 %}
<div class="fall-pumpkins">
	{% for i in range(count) %}
	<div class="fall-pumpkin">
		<img src="/e/marseypumpking.webp" class="animate-spin" style="width: 40px; height: 40px;" alt="animate marsey pumpkin icon"/>
	</div>
	{% endfor %}
</div>
{% endif %}
